!function(){function t(t){console.log("Initializing..."),c=t.sampleRate,console.log("Initialization complete")}function n(t){var n=t[h],e=t[v];p.push(n),U.push(e),m+=n.length}function e(){var t=a(p,m),n=a(U,m),e=o(t,n),r=i(e,g,c,u),s=new Blob([r],{type:f});console.log("Exporting "+s.size+" byte WAV"),this.postMessage({wavBlob:s})}function a(t,n){for(var e=new Float32Array(n),a=0,o=0;o<t.length;o++){var i=t[o];e.set(i,a),a+=i.length}return e}function o(t,n){for(var e=t.length+n.length,a=new Float32Array(e),o=0,i=0;i<e;)a[i++]=t[o],a[i++]=n[o],o++;return a}function i(t,n,e,a){var o=new ArrayBuffer(44+2*t.length),i=new DataView(o);return r(i,0,"RIFF"),i.setUint32(4,32+2*t.length,!0),r(i,8,"WAVE"),r(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,n,!0),i.setUint32(24,e,!0),i.setUint32(28,4*e,!0),i.setUint16(32,n*a,!0),i.setUint16(34,16,!0),r(i,36,"data"),i.setUint32(40,2*t.length,!0),s(i,44,t),i}function r(t,n,e){for(var a=0;a<e.length;a++)t.setUint8(n+a,e.charCodeAt(a))}function s(t,n,e){for(var a=0;a<e.length;a++,n+=2){var o=Math.max(-1,Math.min(1,e[a]));o=o<0?32768*o:32767*o,t.setInt16(n,o,!0)}}function l(){console.log("Resetting..."),p=[],U=[],m=0,console.log("Reset complete")}var c,f="audio/wav",g=2,u=2,h=0,v=1,p=[],U=[],m=0;this.onmessage=function(a){switch(a.data.command){case"initialize":t(a.data.configuration);break;case"record":n(a.data.inputBuffers);break;case"exportWav":e();break;case"reset":l()}}}();